"use strict";(self["webpackChunkpure_vue"]=self["webpackChunkpure_vue"]||[]).push([[282],{5587:function(e,a,t){t.r(a),t.d(a,{default:function(){return E}});var l=t(3396),o=t(7139),n=t.p+"img/mb-building2.6420df89.jpg",i=t(7312),d=t(11),s=t(1888),u=t(6572),r=t(1334),m=t(1222),c=t(3601),g=t(4075),h=t(6422),f=t(6824),p=t(8521),_=t(9234),w=t(3289),S=t(6075),v=t(3104),W=t(1231),x=t(5869);const b=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",{class:"text-left"},"ลำดับ"),(0,l._)("th",{class:"text-left"},"คำนำหน้า"),(0,l._)("th",{class:"text-left"},"ชื่อ-นามสกุล"),(0,l._)("th",{class:"text-left"},"Action")])],-1),V={style:{display:"flex",gap:"10px"}},C=["src"];function D(e,a,t,D,k,y){return(0,l.wg)(),(0,l.j4)(S.B,{src:n},{default:(0,l.w5)((()=>[(0,l.Wm)(f.o,{justify:"center",class:"fontSarabun"},{default:(0,l.w5)((()=>[(0,l.Wm)(p.D,{cols:"12",sm:"10",md:"8",lg:"6"},{default:(0,l.w5)((()=>[(0,l.Wm)(h.O,{ref:"form","lazy-validation":""},{default:(0,l.w5)((()=>[(0,l.Wm)(d._,{ref:"form",height:"260"},{default:(0,l.w5)((()=>[(0,l.Wm)(s.Z,null,{default:(0,l.w5)((()=>[(0,l.Wm)(f.o,null,{default:(0,l.w5)((()=>[(0,l.Wm)(p.D,null,{default:(0,l.w5)((()=>[(0,l.Wm)(x.h,{label:"ชื่อโครงการ",modelValue:k.dataStorage.pj_name,"onUpdate:modelValue":a[0]||(a[0]=e=>k.dataStorage.pj_name=e),rules:k.textRule,required:""},null,8,["modelValue","rules"])])),_:1}),(0,l.Wm)(p.D,null,{default:(0,l.w5)((()=>[(0,l.Wm)(f.o,null,{default:(0,l.w5)((()=>[(0,l.Wm)(p.D,null,{default:(0,l.w5)((()=>[(0,l.Wm)(v.G,{modelValue:k.dataStorage.language,"onUpdate:modelValue":a[1]||(a[1]=e=>k.dataStorage.language=e),"hide-details":"","true-value":"Eng","false-value":"TH",color:"indigo",label:`ฟอร์ม : ${k.dataStorage.language}`},null,8,["modelValue","label"])])),_:1}),(0,l.Wm)(p.D,null,{default:(0,l.w5)((()=>[(0,l.Wm)(m.x,{label:"ใส่ลายเซ็น ผอ.",modelValue:k.dataStorage.sign,"onUpdate:modelValue":a[2]||(a[2]=e=>k.dataStorage.sign=e),color:"indigo","hide-details":""},null,8,["modelValue"])])),_:1}),(0,l.Wm)(p.D,null,{default:(0,l.w5)((()=>[(0,l.Wm)(m.x,{label:"2 ลายเซ็น",modelValue:k.dataStorage.two_sign,"onUpdate:modelValue":a[3]||(a[3]=e=>k.dataStorage.two_sign=e),color:"indigo-darken-3","hide-details":""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.Wm)(f.o,{class:"mt-n8"},{default:(0,l.w5)((()=>[(0,l.Wm)(p.D,null,{default:(0,l.w5)((()=>[(0,l.Wm)(x.h,{label:"รหัสโครงการ",id:"pj_name",modelValue:k.dataStorage.pj_code,"onUpdate:modelValue":a[4]||(a[4]=e=>k.dataStorage.pj_code=e),rules:k.textRule,onInput:y.handleInput},null,8,["modelValue","rules","onInput"])])),_:1}),(0,l.Wm)(p.D,null,{default:(0,l.w5)((()=>[(0,l.Wm)(x.h,{label:"ชื่อ",modelValue:k.dataStorage.add_name,"onUpdate:modelValue":a[5]||(a[5]=e=>k.dataStorage.add_name=e),rules:k.twoSignRule,disabled:!k.dataStorage.two_sign},null,8,["modelValue","rules","disabled"])])),_:1})])),_:1}),(0,l.Wm)(f.o,{class:"mt-n8"},{default:(0,l.w5)((()=>[(0,l.Wm)(p.D,null,{default:(0,l.w5)((()=>[(0,l.Wm)(x.h,{label:"วันที่",modelValue:k.dataStorage.date_desc,"onUpdate:modelValue":a[6]||(a[6]=e=>k.dataStorage.date_desc=e),rules:k.textRule,required:""},null,8,["modelValue","rules"])])),_:1}),(0,l.Wm)(p.D,null,{default:(0,l.w5)((()=>[(0,l.Wm)(x.h,{label:"ตำแหน่ง",modelValue:k.dataStorage.add_position,"onUpdate:modelValue":a[7]||(a[7]=e=>k.dataStorage.add_position=e),rules:k.twoSignRule,disabled:!k.dataStorage.two_sign},null,8,["modelValue","rules","disabled"])])),_:1})])),_:1}),(0,l.Wm)(f.o,null,{default:(0,l.w5)((()=>[(0,l.Wm)(_.C),(0,l.Wm)(i.T,{onClick:y.createPDFShow,class:"mt-n7 mx-2",size:"small",color:"orange",icon:"mdi-refresh"},null,8,["onClick"]),(0,l.Wm)(i.T,{onClick:a[8]||(a[8]=e=>y.addName()),class:"mt-n7 mx-2",size:"small",color:"green",icon:"mdi-account-multiple-plus"})])),_:1})])),_:1}),(0,l.Wm)(g.J,{class:"mt-12"})])),_:1},512),(0,l.Wm)(d._,null,{default:(0,l.w5)((()=>[(0,l.Wm)(W.Y,null,{default:(0,l.w5)((()=>[b,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(k.dataDetail.data,((e,a)=>((0,l.wg)(),(0,l.iD)("tr",{key:e.name},[(0,l._)("td",null,(0,o.zw)(a+1),1),(0,l._)("td",null,(0,o.zw)(e.prefix),1),(0,l._)("td",null,(0,o.zw)(e.name),1),(0,l._)("td",null,[(0,l._)("div",V,[(0,l.Wm)(w.t,{onClick:e=>this.editName(a),style:{color:"rgb(243, 156, 18)"}},{default:(0,l.w5)((()=>[(0,l.Uk)("mdi-pencil")])),_:2},1032,["onClick"]),(0,l.Wm)(w.t,{onClick:e=>y.deleteListName(a),style:{color:"rgb(255, 0, 0)"}},{default:(0,l.w5)((()=>[(0,l.Uk)("mdi-delete")])),_:2},1032,["onClick"])])])])))),128))])])),_:1})])),_:1})])),_:1},512)])),_:1})])),_:1}),(0,l.Wm)(f.o,{justify:"center"},{default:(0,l.w5)((()=>[(0,l.Wm)(i.T,{color:"success",onClick:y.validateCheck},{default:(0,l.w5)((()=>[(0,l.Uk)("Confirm")])),_:1},8,["onClick"]),(0,l.Wm)(i.T,{class:"ml-5",color:"red",onClick:a[9]||(a[9]=a=>{this.$router.go(-1),e.$store.state.tabPage="two"})},{default:(0,l.w5)((()=>[(0,l.Uk)("Cancel")])),_:1})])),_:1}),(0,l.Wm)(c.B,{modelValue:k.mangeName.dialog,"onUpdate:modelValue":a[13]||(a[13]=e=>k.mangeName.dialog=e),"max-width":"400"},{default:(0,l.w5)((()=>[(0,l.Wm)(d._,null,{default:(0,l.w5)((()=>[(0,l.Wm)(u.E,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(1===k.selectPopupShow?"เพิ่มรายชื่อ":"กรุณาใส่ชื่อ-นามสกุล ที่ต้องการเปลี่ยน"),1)])),_:1}),(0,l.Wm)(s.Z,null,{default:(0,l.w5)((()=>[(0,l.Wm)(x.h,{label:"คำนำหน้า",modelValue:k.mangeName.prefix,"onUpdate:modelValue":a[10]||(a[10]=e=>k.mangeName.prefix=e)},null,8,["modelValue"]),(0,l.Wm)(x.h,{label:"ชื่อ-นามสกุล",modelValue:k.mangeName.name,"onUpdate:modelValue":a[11]||(a[11]=e=>k.mangeName.name=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(r.h,null,{default:(0,l.w5)((()=>[(0,l.Wm)(i.T,{color:"red",onClick:a[12]||(a[12]=e=>k.mangeName.dialog=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("ยกเลิก")])),_:1}),(0,l.Wm)(i.T,{color:"success",onClick:y.saveName},{default:(0,l.w5)((()=>[(0,l.Uk)("บันทึก")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(f.o,{justify:"center"},{default:(0,l.w5)((()=>[(0,l._)("div",null,[k.preview?((0,l.wg)(),(0,l.iD)("iframe",{key:0,src:k.base_64,ref:"pdfIframe"},null,8,C)):(0,l.kq)("",!0)])])),_:1})])),_:1})}t(560);var k=t(2492),y=t.n(k),N=t(9654),U=t(5479),j={data(){return{dataDetail:[],base_64:null,excel_array:null,preview:!1,loadingBtn:!1,selectPopupShow:null,dataStorage:[],indexEdit:null,mangeName:{dialog:!1,prefix:null,name:null},textRule:[e=>!!e||"กรุณาใส่ข้อความ"],twoSignRule:[e=>!this.dataStorage.two_sign||(!!e||"กรุณาใส่ข้อความ")]}},mounted(){const e=localStorage.getItem("certificate_data");this.dataStorage=JSON.parse(e),this.mangeName.pj_code=this.dataStorage.pj_code,this.getDataCertificateDetail()},methods:{handleInput(){this.dataStorage.pj_code=this.dataStorage.pj_code.replace(/[^A-Za-z0-9-]/g,""),this.dataStorage.pj_code=this.dataStorage.pj_code.slice(0,12)},validateCheck(){this.$refs.form.validate(),this.dataStorage.pj_code&&this.dataStorage.pj_name&&this.dataStorage.date_desc&&(!this.dataStorage.two_sign||this.dataStorage.add_name&&this.dataStorage.add_position)&&this.confirmUpdate()},confirmUpdate(){y().fire({title:"บันทึกการเปลี่ยนแปลง ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#228B22",cancelButtonColor:"#d33",confirmButtonText:"บันทึก",cancelButtonText:"ยกเลิก"}).then((async e=>{if(e.isConfirmed){const e=await N.Z.updateCertificate(this.dataStorage,this.dataDetail.data);"ok"===e.data.msg?(localStorage.setItem("certificate_data",JSON.stringify(this.dataStorage)),this.$store.state.certificate_data=this.dataStorage,this.$router.push({name:"Certificate-Edit"}),this.showAlert("success","แก้ไขข้อมูลสำเร็จ")):this.showAlert("error","ไม่สามารถแก้ไขได้กรุณาลองใหม่อีกครัง")}}))},async createPDFShow(){const e=await U.Z.certification_pdf(this.dataDetail.data,this.dataStorage);e.getDataUrl((e=>{this.base_64=e;const a=this.$refs.pdfIframe;a.src=e,a.style.width="770px",a.style.height="600px"})),this.preview=!0},async getDataCertificateDetail(){const e=await N.Z.getDataCertificate_detail(this.dataStorage);this.dataDetail=e.data},showAlert(e,a){y().fire({position:"center",icon:e,title:a,showConfirmButton:!1,timer:2e3})},editName(e){this.indexEdit=e,this.mangeName.dialog=!0,this.mangeName.prefix=this.dataDetail.data[this.indexEdit].prefix,this.mangeName.name=this.dataDetail.data[this.indexEdit].name,this.selectPopupShow=2},addName(){this.mangeName={dialog:!0,prefix:null,name:null},this.selectPopupShow=1},async saveName(){this.mangeName.dialog=!1,1===this.selectPopupShow?this.dataDetail.data.push(this.mangeName):this.dataDetail.data[this.indexEdit]=this.mangeName,this.mangeName={dialog:!1,prefix:null,name:null},this.selectPopupShow=null},deleteListName(e){this.dataDetail.data.splice(e,1)}},watch:{"dataStorage.two_sign":{handler(e){e||(this.dataStorage.add_name=null,this.dataStorage.add_position=null)},immediate:!0}}},P=t(89);const B=(0,P.Z)(j,[["render",D]]);var E=B},6075:function(e,a,t){t.d(a,{B:function(){return _}});var l=t(3396),o=t(2718),n=t(8157),i=t(9166),d=t(1477),s=t(3712),u=t(4870),r=t(3766),m=t(1107),c=t(8582),g=t(131),h=t(9888);function f(e){return Math.floor(Math.abs(e))*Math.sign(e)}const p=(0,r.U)({scale:{type:[Number,String],default:.5},...(0,i.l)()},"VParallax"),_=(0,m.ev)()({name:"VParallax",props:p(),setup(e,a){let{slots:t}=a;const{intersectionRef:i,isIntersecting:r}=(0,d.S)(),{resizeRef:m,contentRect:p}=(0,s.y)(),{height:_}=(0,n.AW)(),w=(0,u.iH)();let S;(0,l.m0)((()=>{i.value=m.value=w.value?.$el})),(0,l.YP)(r,(e=>{e?(S=(0,c.rP)(i.value),S=S===document.scrollingElement?document:S,S.addEventListener("scroll",x,{passive:!0}),x()):S.removeEventListener("scroll",x)})),(0,l.Jd)((()=>{S?.removeEventListener("scroll",x)})),(0,l.YP)(_,x),(0,l.YP)((()=>p.value?.height),x);const v=(0,l.Fl)((()=>1-(0,g.uZ)(+e.scale)));let W=-1;function x(){r.value&&(cancelAnimationFrame(W),W=requestAnimationFrame((()=>{const e=(w.value?.$el).querySelector(".v-img__img");if(!e)return;const a=S instanceof Document?document.documentElement.clientHeight:S.clientHeight,t=S instanceof Document?window.scrollY:S.scrollTop,l=i.value.getBoundingClientRect().top+t,o=p.value.height,n=l+(o-a)/2,d=f((t-n)*v.value),s=Math.max(1,(v.value*(a-o)+o)/o);e.style.setProperty("transform",`translateY(${d}px) scale(${s})`)})))}return(0,h.L)((()=>(0,l.Wm)(o.f,{class:["v-parallax",{"v-parallax--active":r.value},e.class],style:e.style,ref:w,cover:!0,onLoadstart:x,onLoad:x},t))),{}}})},1231:function(e,a,t){t.d(a,{Y:function(){return g},g:function(){return c}});var l=t(3396),o=t(9166),n=t(9694),i=t(1138),d=t(5935),s=t(3766),u=t(1107),r=t(9888),m=t(131);const c=(0,s.U)({fixedHeader:Boolean,fixedFooter:Boolean,height:[Number,String],hover:Boolean,...(0,o.l)(),...(0,n.f)(),...(0,i.Q)(),...(0,d.x$)()},"VTable"),g=(0,u.ev)()({name:"VTable",props:c(),setup(e,a){let{slots:t,emit:o}=a;const{themeClasses:i}=(0,d.ER)(e),{densityClasses:s}=(0,n.t)(e);return(0,r.L)((()=>(0,l.Wm)(e.tag,{class:["v-table",{"v-table--fixed-height":!!e.height,"v-table--fixed-header":e.fixedHeader,"v-table--fixed-footer":e.fixedFooter,"v-table--has-top":!!t.top,"v-table--has-bottom":!!t.bottom,"v-table--hover":e.hover},i.value,s.value,e.class],style:e.style},{default:()=>[t.top?.(),t.default?(0,l.Wm)("div",{class:"v-table__wrapper",style:{height:(0,m.kb)(e.height)}},[(0,l.Wm)("table",null,[t.default()])]):t.wrapper?.(),t.bottom?.()]}))),{}}})}}]);